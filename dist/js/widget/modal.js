!function(a,b,c){"function"==typeof define&&define.amd?define(c):"undefined"!=typeof module&&module.exports?module.exports=c():b[a]=c()}("Modal",this,function(){"use strict";function a(a){this.target=a,this.isOpen||this._init()}return a.prototype._init=function(){var a=this;this.overlay=document.createElement("div"),this.overlay.className="overlay",this.overlay.setAttribute("tabindex",-1),this.modalWindow=document.createElement("div"),this.modalWindow.className="modal",this.modalWindow.setAttribute("role","dialog"),this.modalWindow.setAttribute("tabindex",0),this.modalWrapper=document.createElement("div"),this.modalWrapper.className="modal__wrapper",this.modalContent=document.createElement("div"),this.modalContent.className="modal__content",this.closeButton=document.createElement("button"),this.closeButton.className="modal__close",this.closeButton.innerHTML="Close",this.closeButton.setAttribute("type","button"),this.closeButton.onclick=function(){a.close()},this.escapeHandler=function(b){27===b.keyCode&&a.close()},this.focusHandler=function(b){a.modalWrapper.contains(b.target)||(b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,a.modalContent.focus())},this.modalWindow.appendChild(this.modalWrapper),this.modalWrapper.appendChild(this.modalContent),this.modalWindow.appendChild(this.closeButton),this.trigger=null,this.isOpen=!1},a.prototype.open=function(a,b){if(!this.isOpen){a&&this.update(a);for(var c=0,d=this.target.children.length;d>c;c++)this.target.children[c].setAttribute("aria-hidden",!0);this.target.appendChild(this.overlay),this.target.appendChild(this.modalWindow),window.addEventListener?(window.addEventListener("focus",this.focusHandler,!1),window.addEventListener("keyup",this.escapeHandler,!1)):(window.attachEvent("onfocus",this.focusHandler),window.attachEvent("onkeyup",this.escapeHandler)),this.trigger=document.activeElement,this.modalWindow.focus(),this.isOpen=!0,b&&b.call(this)}},a.prototype.update=function(a){this.modalContent.innerHTML=a},a.prototype.close=function(a){window.removeEventListener?(window.removeEventListener("focus",this.focusHandler,!1),window.removeEventListener("keyup",this.escapeHandler,!1)):(window.detachEvent("onfocus",this.focusHandler),window.detachEvent("onkeyup",this.escapeHandler)),this.target.removeChild(this.modalWindow),this.target.removeChild(this.overlay);for(var b=0,c=this.target.children.length;c>b;b++)this.target.children[b].removeAttribute("aria-hidden");this.trigger&&(this.trigger.focus(),this.trigger=null),this.isOpen=!1,a&&a.call(this)},a.prototype.teardown=function(){this.isOpen&&this.close(),delete this.escapeHandler,delete this.focusHandler,delete this.closeButton,delete this.modalContent,delete this.modalWrapper,delete this.modalWindow,delete this.overlay,delete this.trigger,delete this.isOpen},a});